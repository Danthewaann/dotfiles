#!/usr/bin/env bash

set -e

CUR_DIR=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )

source "$CUR_DIR/_git-common"

if ! in_worktree=$(git rev-parse --is-inside-work-tree 2>&1); then true; fi
if [[ $in_worktree == "true" ]]; then
    gitw-update-base
    base_worktree=$(gitw-get-base 2> /dev/null)
    >&2 echo
    >&2 echo "Rebasing with '$base_worktree' base worktree"
    >&2 git rebase "$base_worktree"
else
    >&2 echo
    error "Must be run inside a git worktree"
    exit 1
fi

