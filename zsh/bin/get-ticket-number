#!/usr/bin/env python

import subprocess
import sys
import re
import _utils

current_branch = (
    sys.argv[1]
    if len(sys.argv) > 1
    else subprocess.check_output(["git", "branch", "--show-current"], text=True).strip()
)

# Extract the ticket number from the branch name
if match := re.search(r"/\D*(\d+)\D*/", current_branch):
    print(match.group(1))
    sys.exit(0)

# If no ticket number is found, print an error and exit
_utils.error(f"No ticket number found for {current_branch}")
sys.exit(1)
